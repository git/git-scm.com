---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: ms
  chapter:
    title: Git Internals
    number: 10
  section:
    title: The Refspec
    number: 5
    cs_number: '10.5'
    previous: book/ms/v2/Git-Internals-Packfiles
    next: book/ms/v2/Git-Internals-Transfer-Protocols
title: Git - The Refspec
---
<h2 id="_refspec">The Refspec</h2>
<div class="paragraph">
<p>Throughout this book, we’ve used simple mappings from remote branches to local references, but they can be more complex.
Suppose you were following along with the last couple sections and had created a small local Git repository, and now wanted to add a <em>remote</em> to it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git remote add origin https://github.com/schacon/simplegit-progit</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the command above adds a section to your repository’s <code>.git/config</code> file, specifying the name of the remote (<code>origin</code>), the URL of the remote repository, and the <em>refspec</em> to be used for fetching:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[remote "origin"]
	url = https://github.com/schacon/simplegit-progit
	fetch = +refs/heads/*:refs/remotes/origin/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>The format of the refspec is, first, an optional <code>`, followed by `&lt;src&gt;:&lt;dst&gt;`, where `&lt;src&gt;` is the pattern for references on the remote side and `&lt;dst&gt;` is where those references will be tracked locally.
The `</code> tells Git to update the reference even if it isn’t a fast-forward.</p>
</div>
<div class="paragraph">
<p>In the default case that is automatically written by a <code>git remote add origin</code> command, Git fetches all the references under <code>refs/heads/</code> on the server and writes them to <code>refs/remotes/origin/</code> locally.
So, if there is a <code>master</code> branch on the server, you can access the log of that branch locally via any of the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git log origin/master
$ git log remotes/origin/master
$ git log refs/remotes/origin/master</code></pre>
</div>
</div>
<div class="paragraph">
<p>They’re all equivalent, because Git expands each of them to <code>refs/remotes/origin/master</code>.</p>
</div>
<div class="paragraph">
<p>If you want Git instead to pull down only the <code>master</code> branch each time, and not every other branch on the remote server, you can change the fetch line to refer to that branch only:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>fetch = +refs/heads/master:refs/remotes/origin/master</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is just the default refspec for <code>git fetch</code> for that remote.
If you want to do a one-time only fetch, you can specify the specific refspec on the command line, too.
To pull the <code>master</code> branch on the remote down to <code>origin/mymaster</code> locally, you can run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git fetch origin master:refs/remotes/origin/mymaster</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify multiple refspecs.
On the command line, you can pull down several branches like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git fetch origin master:refs/remotes/origin/mymaster \
	 topic:refs/remotes/origin/topic
From git@github.com:schacon/simplegit
 ! [rejected]        master     -&gt; origin/mymaster  (non fast forward)
 * [new branch]      topic      -&gt; origin/topic</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the <code>master</code> branch pull was rejected because it wasn’t listed as a fast-forward reference.
You can override that by specifying the <code>+</code> in front of the refspec.</p>
</div>
<div class="paragraph">
<p>You can also specify multiple refspecs for fetching in your configuration file.
If you want to always fetch the <code>master</code> and <code>experiment</code> branches from the <code>origin</code> remote, add two lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[remote "origin"]
	url = https://github.com/schacon/simplegit-progit
	fetch = +refs/heads/master:refs/remotes/origin/master
	fetch = +refs/heads/experiment:refs/remotes/origin/experiment</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since Git 2.6.0 you can use partial globs in the pattern to match multiple branches, so this works:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">fetch = +refs/heads/qa*:refs/remotes/origin/qa*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Even better, you can use namespaces (or directories) to accomplish the same with more structure.
If you have a QA team that pushes a series of branches, and you want to get the <code>master</code> branch and any of the QA team’s branches but nothing else, you can use a config section like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[remote "origin"]
	url = https://github.com/schacon/simplegit-progit
	fetch = +refs/heads/master:refs/remotes/origin/master
	fetch = +refs/heads/qa/*:refs/remotes/origin/qa/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have a complex workflow process that has a QA team pushing branches, developers pushing branches, and integration teams pushing and collaborating on remote branches, you can namespace them easily this way.</p>
</div>
<div class="sect3">
<h3 id="_pushing_refspecs">Pushing Refspecs</h3>
<div class="paragraph">
<p>It’s nice that you can fetch namespaced references that way, but how does the QA team get their branches into a <code>qa/</code> namespace in the first place?
You accomplish that by using refspecs to push.</p>
</div>
<div class="paragraph">
<p>If the QA team wants to push their <code>master</code> branch to <code>qa/master</code> on the remote server, they can run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push origin master:refs/heads/qa/master</code></pre>
</div>
</div>
<div class="paragraph">
<p>If they want Git to do that automatically each time they run <code>git push origin</code>, they can add a <code>push</code> value to their config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[remote "origin"]
	url = https://github.com/schacon/simplegit-progit
	fetch = +refs/heads/*:refs/remotes/origin/*
	push = refs/heads/master:refs/heads/qa/master</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, this will cause a <code>git push origin</code> to push the local <code>master</code> branch to the remote <code>qa/master</code> branch by default.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You cannot use the refspec to fetch from one repository and push to another one.
For an example to do so, refer to <a href="{{< relurl "book/ms/v2/ch00/_fetch_and_push_on_different_repositories" >}}">Keep your GitHub public repository up-to-date</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h3 id="_deleting_references">Deleting References</h3>
<div class="paragraph">
<p>You can also use the refspec to delete references from the remote server by running something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push origin :topic</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because the refspec is <code>&lt;src&gt;:&lt;dst&gt;</code>, by leaving off the <code>&lt;src&gt;</code> part, this basically says to make the <code>topic</code> branch on the remote nothing, which deletes it.</p>
</div>
<div class="paragraph">
<p>Or you can use the newer syntax (available since Git v1.7.0):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push origin --delete topic</code></pre>
</div>
</div>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>